<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Trabalho Final Marketing - Antonio Paneguini, Pedro Miné, Victor Tokunaga</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Trabalho_Final_Markteting_files/libs/clipboard/clipboard.min.js"></script>
<script src="Trabalho_Final_Markteting_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Trabalho_Final_Markteting_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Trabalho_Final_Markteting_files/libs/quarto-html/popper.min.js"></script>
<script src="Trabalho_Final_Markteting_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Trabalho_Final_Markteting_files/libs/quarto-html/anchor.min.js"></script>
<link href="Trabalho_Final_Markteting_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Trabalho_Final_Markteting_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Trabalho_Final_Markteting_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Trabalho_Final_Markteting_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Trabalho_Final_Markteting_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Trabalho Final Marketing - Antonio Paneguini, Pedro Miné, Victor Tokunaga</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introdução" class="level3">
<h3 class="anchored" data-anchor-id="introdução">Introdução</h3>
<p>Neste relatório, nos dedicamos a criar uma analise de percepção de marcas de Petiscos de Cachorro para podermos entender quais são os termos mais importantes e frequentes tidos pelos clientes quando eles consideram comprar um biscoito em um mercado pet cada vez mais inserido nas dinamicas familiares modernas, onde o cuidado do animal de estimação se torna prioridade alta por partes dos tutores. O relatório sera feito baseado em uma pesquisa previamente realizada pela empresa Petí, vendedora de petiscos saudáveis para animais de estimação. Tendo um foco maior nos petiscos hipoalergenicos (baixo risco de gerar alergias)</p>
<section id="contextualização" class="level4">
<h4 class="anchored" data-anchor-id="contextualização">Contextualização</h4>
<p>A empresa Petí, atuante no mercado de Pet Treats, estava interessada em analises de percepção de seus proprios produtos e o posicionamento de si mesma no mercado. Para poder dimensionalizar sua situação, foi primeiro necessario fazer uma analise dos concorrentes para se inserir eles no mercado e ter uma ideia de seu posicionamento em relação a eles.</p>
<p>Como a Petí não dispões de uma volumetria alta de dados sobre a percepção dos clientes sobre si, foi dado preferencia a tentar se projetar perto de empresas que usam produtos e linguagens semelhantes. Apos algumas analises de clusterização preliminares (pode ser lida no arquivo <em>Analise_Predição_Petisco_Bifinho.html</em> incluso, mas nao sera o foco do trabalho), foi apresentado para os socios uma lista de empresas que foram identificadas como potenciais concorrentes. Em uma votação cega, os sócios deveriam votar em quem eles achassem que era um potencial concorrente direto, dando uma pontuação binaria de 1 ou 0. Ao final da votação, o score total de cada marca foi somado com um maximo de tres:</p>
<ul>
<li>Risco Alto (3 pontos)</li>
<li>Risco Médio (2 pontos)</li>
<li>Risco Baixo (1 ponto)</li>
<li>Risco Nulo (0 pontos, ninguem votou nessa marca)</li>
</ul>
</section>
<section id="base-de-dados" class="level4">
<h4 class="anchored" data-anchor-id="base-de-dados">Base de Dados</h4>
<p>A base foi extraida por meio de Web Scraping do site de e-commerce da empresa <strong>PetLove</strong> (https://www.petlove.com.br) realizado por bots usando a biblioteca Selenium do Python. Uma versão do script utilizado esta disponivel em: https://github.com/AntonioInsper/webscraper-petlove</p>
</section>
<section id="metodologia-de-webscraping" class="level4">
<h4 class="anchored" data-anchor-id="metodologia-de-webscraping">Metodologia de WebScraping</h4>
<p>Foi orçado palavras-chave relevantes que potencias consumidores colocariam na barra de pesquisa de e-commerces, o bot iria colar as palavras -chaves armazenadas em uma lista na barra de pesuisa, entraroa dentro de cada item dipsonibilizado pela consulta, retiraria informação gerais de cada produto, as avaliações, os títulos as notas das avaliações e as questões dos clientes. As palavras-chaves utilizadas foram as que mais se encaixavam no perfil de produtos da Petí:</p>
<ul>
<li>Petisco Natural Cães</li>
<li>Petisco natural</li>
<li>Petisco hipoalergenico</li>
<li>petisco suplementoso</li>
<li>Petisco calmante</li>
<li>petisco Super Premium</li>
<li>inseto</li>
<li>insect</li>
<li>Hipoalergenico</li>
<li>mordedor</li>
<li>Gastro</li>
<li>Bifinho</li>
<li>Bifinho Super Premium</li>
<li>Bifinho Natural</li>
<li>Bifinho hipoalergenico</li>
<li>tenebrio</li>
<li>Alimentação natural fresca</li>
<li>Mordedor natural</li>
<li>suplemento animal</li>
</ul>
</section>
</section>
<section id="transformações" class="level3">
<h3 class="anchored" data-anchor-id="transformações">Transformações</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/home/antonio/Insper/Marketing Analytics/Trabalho Final"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">use_virtualenv</span>(<span class="st">"./.venv"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud, STOPWORDS</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'stopwords'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree <span class="co"># Import Decision Tree Classifier</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split <span class="co"># Import train_test_split function</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse <span class="im">import</span> hstack </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> label_binarize</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, auc</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.multiclass <span class="im">import</span> OneVsRestClassifier</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> RocCurveDisplay</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> ConfusionMatrixDisplay, confusion_matrix</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.multiclass <span class="im">import</span> OneVsRestClassifier</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extrair_searchword(nome_arquivo):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    match <span class="op">=</span> re.search(<span class="vs">r"SEARCHWORD</span><span class="kw">(</span><span class="dv">\d</span><span class="op">+</span><span class="kw">)</span><span class="vs">"</span>, nome_arquivo)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(match.group(<span class="dv">1</span>)) <span class="cf">if</span> match <span class="cf">else</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'df_risco_conc.csv'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Palavra_Chave'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array(['insect', 'Hipoalergenico', 'Petisco Natural Cães', 'mordedor',
       'inseto', 'petisco Super Premium', 'Gastro',
       'Bifinho Super Premium', 'suplemento animal', 'Bifinho Natural',
       'Petisco calmante', 'petisco suplementoso', 'Petisco natural',
       'Petisco hipoalergenico', 'Alimentação natural fresca', 'Bifinho'],
      dtype=object)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_petisco <span class="op">=</span> df[df[<span class="st">'Palavra_Chave'</span>].isin([<span class="st">'Petisco calmante'</span>,<span class="st">'Petisco Natural Cães'</span>,<span class="st">'petisco Super Premium'</span>,<span class="st">'petisco suplementoso'</span>,<span class="st">'Petisco hipoalergenico'</span>, <span class="st">'Bifinho Super Premium'</span>,<span class="st">'Bifinho'</span>,<span class="st">'Bifinho Natural'</span>,<span class="st">'Bifinho Super Premium'</span>])]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df_petisco <span class="op">=</span> df_petisco[df_petisco[<span class="st">'Qtde_Aval'</span>] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df_petisco[[<span class="st">'Risco_Concorrencia_Predito'</span>, <span class="st">'Nota_Produto'</span>, <span class="st">'Qtde_Aval'</span>]].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Risco_Concorrencia_Predito  Nota_Produto  Qtde_Aval
Risco Alto                  5.0           1            20
Risco Baixo                 5.0           1             9
Risco Alto                  1.0           1             4
                            4.8           16            4
                            5.0           3             4
                                                       ..
Risco Médio                 4.0           1             1
                            3.8           12            1
                            3.7           6             1
                                          3             1
                            5.0           3             1
Name: count, Length: 79, dtype: int64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_petisco[[<span class="st">'Marca_Produto'</span>, <span class="st">'Risco_Concorrencia_Predito'</span>]].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marca_Produto    Risco_Concorrencia_Predito
wow-pet-food     Risco Alto                    20
natural-crisp    Risco Alto                    20
spin             Risco Alto                    20
petvegan         Risco Médio                   14
mastig           Risco Alto                    13
xisdog           Risco Baixo                   10
nutrilus-pro     Risco Baixo                    8
mister-maskoto   Risco Médio                    7
natural-farm     Risco Alto                     4
alles-pet        Risco Alto                     4
origens          Risco Baixo                    4
organnact        Risco Alto                     4
baw-waw          Risco Baixo                    3
desidrat         Risco Alto                     3
oh-lala-pet      Risco Alto                     3
just             Risco Alto                     2
premier          Risco Médio                    2
papapets         Risco Médio                    2
the-pet-s-taste  Risco Alto                     2
quatree          Risco Baixo                    2
pettreats        Risco Médio                    1
simple-dog       Risco Baixo                    1
Name: count, dtype: int64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_petisco <span class="op">=</span> df_petisco[df_petisco[<span class="st">'Risco_Concorrencia_Predito'</span>] <span class="op">!=</span> <span class="st">'Risco Nulo'</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_petisco <span class="op">=</span> df_petisco[<span class="op">~</span>df_petisco[<span class="st">'Nome_Produto'</span>].<span class="bu">str</span>.contains(<span class="st">'Gatos'</span>)]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_petisco  <span class="op">=</span> df_petisco[<span class="op">~</span>df_petisco[<span class="st">'Nome_Produto'</span>].<span class="bu">str</span>.contains(<span class="st">'Ração'</span>)]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df_petisco[[<span class="st">'Marca_Produto'</span>, <span class="st">'Risco_Concorrencia_Predito'</span>]].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marca_Produto    Risco_Concorrencia_Predito
natural-crisp    Risco Alto                    18
spin             Risco Alto                    16
petvegan         Risco Médio                   14
wow-pet-food     Risco Alto                    13
mastig           Risco Alto                    11
xisdog           Risco Baixo                   10
mister-maskoto   Risco Médio                    7
nutrilus-pro     Risco Baixo                    7
alles-pet        Risco Alto                     4
origens          Risco Baixo                    4
organnact        Risco Alto                     4
natural-farm     Risco Alto                     4
baw-waw          Risco Baixo                    3
oh-lala-pet      Risco Alto                     3
desidrat         Risco Alto                     3
just             Risco Alto                     2
papapets         Risco Médio                    2
quatree          Risco Baixo                    2
the-pet-s-taste  Risco Alto                     2
simple-dog       Risco Baixo                    1
pettreats        Risco Médio                    1
Name: count, dtype: int64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>diretorio <span class="op">=</span> Path(<span class="st">"Comentarios"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cmmt_files <span class="op">=</span> <span class="bu">list</span>(diretorio.glob(<span class="st">"ComentariosPetlove*"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>arquivos_ordenados <span class="op">=</span> <span class="bu">sorted</span>(cmmt_files, key<span class="op">=</span><span class="kw">lambda</span> x:extrair_searchword(<span class="bu">str</span>(x)))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> [pd.read_csv(arquivo) <span class="cf">for</span> arquivo <span class="kw">in</span> arquivos_ordenados]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df_cmmt <span class="op">=</span> pd.concat (dfs, ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;string&gt;:1: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc <span class="op">=</span> df_cmmt[df_cmmt[<span class="st">'Produto'</span>].isin(df_petisco[<span class="st">'Nome_Produto'</span>])]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc.rename(columns<span class="op">=</span>{<span class="st">'Produto'</span> : <span class="st">'Nome_Produto'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;string&gt;:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc <span class="op">=</span> df_cmmt_conc.merge(df_petisco[[<span class="st">'Nome_Produto'</span>, <span class="st">'Risco_Concorrencia_Predito'</span>]], on<span class="op">=</span><span class="st">'Nome_Produto'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc <span class="op">=</span> df_cmmt_conc[df_cmmt_conc[<span class="st">'Palavra_Chave'</span>].isin(df_petisco[<span class="st">'Palavra_Chave'</span>])]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc.rename(columns<span class="op">=</span>{<span class="st">'Nome_Comentario'</span> : <span class="st">'Nomes'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc[<span class="st">'Comentários'</span>] <span class="op">=</span> df_cmmt_conc[<span class="st">'Comentários'</span>].fillna(<span class="st">"Nenhum comentário redigido"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc <span class="op">=</span> df_cmmt_conc.iloc[:,<span class="dv">1</span>:]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>df_cmmt_conc[<span class="st">'Marca'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array(['alles-pet', 'petvegan', 'natural-crisp', 'mastig',
       'the-pet-s-taste', 'wow-pet-food', 'mister-maskoto', 'organnact',
       'spin'], dtype=object)</code></pre>
</div>
</div>
<p>Após as limpezas, descemos o numero de marcas para apenas 9 marcas com dados relevantes a serem analisados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringi)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd('/home/antonio/Insper/Marketing Analytics/Trabalho Final')</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>df  <span class="ot">&lt;-</span> py<span class="sc">$</span>df_cmmt_conc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df  <span class="ot">&lt;-</span> df  <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(Link, Nomes, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(df, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Título Nota_Avaliação      Nomes
0          Bom              5      Thaís
2     Perfeito              5    Tatiana
4 Muito bom!!!              5    Viviane
6        Sabor              2    Edimara
8          Bom              3 Elessandra
                                                                                                                                                                                       Comentários
0 Minha cachorrinha tem alergia alimentar e o petisco foi super aprovado. Não deu nenhuma reação e ela gostou do sabor. Só não ficou calminha pq é uma pinscher e é naturalmente estressada hehehe
2                                                                                                                                                                                      Maravilhosa
4                                                                                                                                                                  Deixa pet mais calmo!! Buldogue
6                                                                                                                        Muito amargo… é muito cheiro de camomila, meus dogs não se interessaram..
8                                                                                                                                                                                   Meu cão gostou
    Data_Comentario     Marca
0  17/11/2024 19:57 alles-pet
2  01/07/2024 08:19 alles-pet
4  27/11/2023 19:11 alles-pet
6  28/12/2022 20:08 alles-pet
8  16/12/2022 21:55 alles-pet
                                           Nome_Produto
0 Biscoito Hipoalergênico Alles Pet Maracujá e Camomila
2 Biscoito Hipoalergênico Alles Pet Maracujá e Camomila
4 Biscoito Hipoalergênico Alles Pet Maracujá e Camomila
6 Biscoito Hipoalergênico Alles Pet Maracujá e Camomila
8 Biscoito Hipoalergênico Alles Pet Maracujá e Camomila
                                                                                               Link
0 https://www.petlove.com.br/biscoito-hipoalergenico-alles-pet-maracuja-e-camomila/p?sku=3102751365
2 https://www.petlove.com.br/biscoito-hipoalergenico-alles-pet-maracuja-e-camomila/p?sku=3102751365
4 https://www.petlove.com.br/biscoito-hipoalergenico-alles-pet-maracuja-e-camomila/p?sku=3102751365
6 https://www.petlove.com.br/biscoito-hipoalergenico-alles-pet-maracuja-e-camomila/p?sku=3102751365
8 https://www.petlove.com.br/biscoito-hipoalergenico-alles-pet-maracuja-e-camomila/p?sku=3102751365
     Palavra_Chave Risco_Concorrencia_Predito
0 Petisco calmante                 Risco Alto
2 Petisco calmante                 Risco Alto
4 Petisco calmante                 Risco Alto
6 Petisco calmante                 Risco Alto
8 Petisco calmante                 Risco Alto</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">7558</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Título</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">441</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nomes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">543</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Comentários</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1041</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">686</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Data_Comentario</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">736</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marca</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nome_Produto</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Link</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Palavra_Chave</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Risco_Concorrencia_Predito</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Nota_Avaliação</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.55</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="topic-models" class="level4">
<h4 class="anchored" data-anchor-id="topic-models">Topic Models</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: NLP</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'NLP'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    annotate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(slam)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stopwords</span>(<span class="st">"pt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "de"           "a"            "o"            "que"          "e"           
  [6] "do"           "da"           "em"           "um"           "para"        
 [11] "com"          "não"          "uma"          "os"           "no"          
 [16] "se"           "na"           "por"          "mais"         "as"          
 [21] "dos"          "como"         "mas"          "ao"           "ele"         
 [26] "das"          "à"            "seu"          "sua"          "ou"          
 [31] "quando"       "muito"        "nos"          "já"           "eu"          
 [36] "também"       "só"           "pelo"         "pela"         "até"         
 [41] "isso"         "ela"          "entre"        "depois"       "sem"         
 [46] "mesmo"        "aos"          "seus"         "quem"         "nas"         
 [51] "me"           "esse"         "eles"         "você"         "essa"        
 [56] "num"          "nem"          "suas"         "meu"          "às"          
 [61] "minha"        "numa"         "pelos"        "elas"         "qual"        
 [66] "nós"          "lhe"          "deles"        "essas"        "esses"       
 [71] "pelas"        "este"         "dele"         "tu"           "te"          
 [76] "vocês"        "vos"          "lhes"         "meus"         "minhas"      
 [81] "teu"          "tua"          "teus"         "tuas"         "nosso"       
 [86] "nossa"        "nossos"       "nossas"       "dela"         "delas"       
 [91] "esta"         "estes"        "estas"        "aquele"       "aquela"      
 [96] "aqueles"      "aquelas"      "isto"         "aquilo"       "estou"       
[101] "está"         "estamos"      "estão"        "estive"       "esteve"      
[106] "estivemos"    "estiveram"    "estava"       "estávamos"    "estavam"     
[111] "estivera"     "estivéramos"  "esteja"       "estejamos"    "estejam"     
[116] "estivesse"    "estivéssemos" "estivessem"   "estiver"      "estivermos"  
[121] "estiverem"    "hei"          "há"           "havemos"      "hão"         
[126] "houve"        "houvemos"     "houveram"     "houvera"      "houvéramos"  
[131] "haja"         "hajamos"      "hajam"        "houvesse"     "houvéssemos" 
[136] "houvessem"    "houver"       "houvermos"    "houverem"     "houverei"    
[141] "houverá"      "houveremos"   "houverão"     "houveria"     "houveríamos" 
[146] "houveriam"    "sou"          "somos"        "são"          "era"         
[151] "éramos"       "eram"         "fui"          "foi"          "fomos"       
[156] "foram"        "fora"         "fôramos"      "seja"         "sejamos"     
[161] "sejam"        "fosse"        "fôssemos"     "fossem"       "for"         
[166] "formos"       "forem"        "serei"        "será"         "seremos"     
[171] "serão"        "seria"        "seríamos"     "seriam"       "tenho"       
[176] "tem"          "temos"        "tém"          "tinha"        "tínhamos"    
[181] "tinham"       "tive"         "teve"         "tivemos"      "tiveram"     
[186] "tivera"       "tivéramos"    "tenha"        "tenhamos"     "tenham"      
[191] "tivesse"      "tivéssemos"   "tivessem"     "tiver"        "tivermos"    
[196] "tiverem"      "terei"        "terá"         "teremos"      "terão"       
[201] "teria"        "teríamos"     "teriam"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">VCorpus</span>(<span class="fu">VectorSource</span>(df<span class="sc">$</span>Comentários))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removePunctuation)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, stripWhitespace)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeWords, <span class="fu">stopwords</span>(<span class="st">"pt"</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DocumentTermMatrix (DTM)</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(corpus)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove empty rows (required for LDA)</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> dtm[<span class="fu">rowSums</span>(<span class="fu">as.matrix</span>(dtm)) <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Remover documentos vazios (linhas com 0 termos)</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> dtm[<span class="fu">row_sums</span>(dtm) <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Remover termos raros (ex: que aparecem em apenas 1 documento)</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> dtm[, <span class="fu">col_sums</span>(dtm) <span class="sc">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="co"># (opcional) Garantir que DTM final tem conteúdo</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(dtm) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">ncol</span>(dtm) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">"DTM vazio após limpeza!"</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of topics</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># for example, 115 topics</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit LDA using Gibbs sampling</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, <span class="at">k =</span> k, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="dv">777</span>))</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="fu">terms</span>(lda_model, <span class="dv">5</span>)  <span class="co"># top 5 terms per topic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Topic 1  Topic 2    Topic 3     Topic 4   Topic 5    Topic 6      
[1,] "pets"   "adorou"   "frango"    "ótimo"   "amou"     "ama"        
[2,] "fezes"  "comeu"    "pois"      "produto" "amam"     "biscoito"   
[3,] "bem"    "ração"    "embalagem" "pra"     "saudável" "biscoitinho"
[4,] "todos"  "cachorra" "petisco"   "pet"     "biscoito" "dar"        
[5,] "cheiro" "tão"      "amou"      "comprar" "cheiroso" "kkkk"       
     Topic 7   Topic 8     Topic 9   Topic 10    Topic 11 Topic 12   Topic 13
[1,] "bom"     "bastante"  "duro"    "excelente" "parece" "gostaram" "ração" 
[2,] "cheiro"  "amaram"    "achei"   "ótima"     "super"  "bem"      "come"  
[3,] "comprei" "cachorros" "gatos"   "custo"     "ser"    "gato"     "vez"   
[4,] "adora"   "bem"       "pedaços" "benefício" "pra"    "ser"      "gosta" 
[5,] "deu"     "petiscos"  "meio"    "ração"     "gostou" "porém"    "única" 
     Topic 14  Topic 15  
[1,] "petisco" "cachorro"
[2,] "natural" "amou"    
[3,] "gatos"   "boa"     
[4,] "amaram"  "pet"     
[5,] "alergia" "macio"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>topic_distributions <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda_model)<span class="sc">$</span>topics</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>term_distributions <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda_model)<span class="sc">$</span>terms</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(topic_distributions), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1         2         3         4         5         6         7
1 0.0035460 0.0035460 0.0035460 0.0035460 0.2551043 0.0035460 0.0035460
2 0.0293495 0.0293495 0.0293495 0.0293495 0.0293495 0.0293495 0.0293495
3 0.0109543 0.0109543 0.0109543 0.0109543 0.6377184 0.0109543 0.0109543
4 0.2638620 0.0090612 0.0090612 0.0090612 0.0090612 0.0090612 0.0090612
5 0.0188167 0.0188167 0.0188167 0.0188167 0.0188167 0.0188167 0.0188167
6 0.0044485 0.0044485 0.0044485 0.0044485 0.0044485 0.0044485 0.0044485
          8         9        10        11        12        13        14
1 0.0035460 0.0035460 0.2064339 0.0035460 0.0035460 0.0035460 0.4959100
2 0.0293495 0.0293495 0.0293495 0.0293495 0.0293495 0.0293495 0.0293495
3 0.0109543 0.0109543 0.0109543 0.0109543 0.2198757 0.0109543 0.0109543
4 0.0090612 0.6183422 0.0090612 0.0090612 0.0090612 0.0090612 0.0090612
5 0.0188167 0.0188167 0.0188167 0.0188167 0.7365657 0.0188167 0.0188167
6 0.0044485 0.0044485 0.0044485 0.0044485 0.0044485 0.2589772 0.0044485
         15
1 0.0035460
2 0.5891065
3 0.0109543
4 0.0090612
5 0.0188167
6 0.6831918</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert topic model to tidy format</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>topics_tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(lda_model)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 terms per topic</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> topics_tidy <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(topic, <span class="sc">-</span>beta)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_terms, <span class="fu">aes</span>(term, beta, <span class="at">fill =</span> <span class="fu">factor</span>(topic))) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Terms per Topic"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"β (term importance)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda_model)<span class="sc">$</span>terms</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">order</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>term_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">colnames</span>(phi)[top_terms])</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> phi[, term_names]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(heatmap_data, <span class="at">cluster_rows =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"Heatmap of Top Terms by Topic"</span>)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dtm_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>terms_df <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(dtm_matrix)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>doc_index <span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">rownames</span>((terms_df)))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>terms_df<span class="sc">$</span>Marca <span class="ot">&lt;-</span> df<span class="sc">$</span>Marca[<span class="fu">as.numeric</span>(<span class="fu">rownames</span>(terms_df))]</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>terms_df<span class="sc">$</span>Score <span class="ot">&lt;-</span> df<span class="sc">$</span>Nota_Avaliação[doc_index]</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>brand_term_avg <span class="ot">&lt;-</span> terms_df <span class="sc">%&gt;%</span> </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span> </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric), <span class="at">.fns =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `summarise()`.
ℹ In argument: `across(.cols = where(is.numeric), .fns = mean, na.rm = TRUE)`.
ℹ In group 1: `Marca = "alles-pet"`.
Caused by warning:
! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
Supply arguments directly to `.fns` through an anonymous function instead.

  # Previously
  across(a:b, mean, na.rm = TRUE)

  # Now
  across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>term_score_corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(brand_term_avg <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Marca), <span class="at">use=</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>term_vs_score <span class="ot">&lt;-</span> term_score_corr[, <span class="st">"Score"</span>]</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>term_vs_score <span class="ot">&lt;-</span> <span class="fu">sort</span>(term_vs_score, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(term_vs_score, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Score        ficar          uso cachorrinhas          faz         alto 
   1.0000000    0.7541872    0.7531175    0.7470225    0.7470225    0.7402951 
    doguinha      energia          bom       apenas 
   0.7402951    0.7402951    0.7387859    0.7360426 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(term_vs_score, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    recebi    retirar   salvação     serviu      tirar   trabalho   umpacote 
-0.8926686 -0.8926686 -0.8926686 -0.8926686 -0.8926686 -0.8926686 -0.8926686 
     volto  condições        pra 
-0.8926686 -0.8947046 -0.9041246 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> <span class="fu">sort</span>(term_vs_score, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>top_terms_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">term =</span> <span class="fu">names</span>(top_terms), <span class="at">corr =</span> top_terms)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_terms_df <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>), <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(term, corr), <span class="at">y =</span> corr)) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Terms Most Positively Correlated with Review Score"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Term"</span>, <span class="at">y =</span> <span class="st">"Correlation with Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>stop_words <span class="op">=</span> stopwords.words(<span class="st">'portuguese'</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>stopwords <span class="op">=</span> stop_words </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>other_words <span class="op">=</span> [<span class="st">'/n'</span>, <span class="st">'Ja'</span>, <span class="st">'dtype'</span>, <span class="st">'Name'</span>, <span class="st">'int'</span>, <span class="st">'Otto'</span>, <span class="st">'gato'</span>, <span class="st">'gata'</span>, <span class="st">'object'</span>, <span class="st">'Comentários'</span>, <span class="st">'Length'</span>, <span class="st">'muita'</span>, <span class="st">'muito'</span>]</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> word <span class="kw">in</span> other_words:</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    stopwords.append(word)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> nota <span class="kw">in</span> df_cmmt_conc[<span class="st">'Nota_Avaliação'</span>].unique():</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    comment_nota <span class="op">=</span> df_cmmt_conc[df_cmmt_conc[<span class="st">'Nota_Avaliação'</span>] <span class="op">==</span>  nota][<span class="st">'Comentários'</span>]</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>nota<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> comment_nota</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    wordcloud <span class="op">=</span> WordCloud(</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>        width <span class="op">=</span> <span class="dv">3000</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span> <span class="dv">2000</span>,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>        background_color<span class="op">=</span> <span class="st">'black'</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>        stopwords<span class="op">=</span> stopwords).generate(<span class="bu">str</span>(text))</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        figsize<span class="op">=</span> (<span class="dv">40</span>,<span class="dv">30</span>),</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        facecolor <span class="op">=</span> <span class="st">'k'</span>,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        edgecolor <span class="op">=</span> <span class="st">'k'</span>)    </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    plt.imshow(wordcloud, interpolation<span class="op">=</span><span class="st">'bilinear'</span>)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout(pad<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5.0
&lt;matplotlib.image.AxesImage object at 0x7fa6c5397e00&gt;
(np.float64(-0.5), np.float64(2999.5), np.float64(1999.5), np.float64(-0.5))
2.0
&lt;matplotlib.image.AxesImage object at 0x7fa6b9db96d0&gt;
(np.float64(-0.5), np.float64(2999.5), np.float64(1999.5), np.float64(-0.5))
3.0
&lt;matplotlib.image.AxesImage object at 0x7fa6b9df1950&gt;
(np.float64(-0.5), np.float64(2999.5), np.float64(1999.5), np.float64(-0.5))
4.0
&lt;matplotlib.image.AxesImage object at 0x7fa6b9e34cd0&gt;
(np.float64(-0.5), np.float64(2999.5), np.float64(1999.5), np.float64(-0.5))
1.0
&lt;matplotlib.image.AxesImage object at 0x7fa6b9188190&gt;
(np.float64(-0.5), np.float64(2999.5), np.float64(1999.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="3840"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="3840"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="3840"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="3840"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid figure-img" width="3840"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="termos-escolhidos" class="level4">
<h4 class="anchored" data-anchor-id="termos-escolhidos">Termos Escolhidos</h4>
<p>Os termos escolhidos foram tanto pelas analises exploratorias iniciais como quanto por decisões de negócios passadas, <em>inputs</em> dos membros do grupo, <em>inputs</em> dos sócios da Petí que consultaram no projeto durante esta fase e subsequenets testes na modelagem de PCA. Apos alguns testes e discussões, chegamos nesta lista de atributos descrita na variavel “termos foco”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>termos_foco &lt;- tolower(c(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  "composição", "natural", "cheiroso", "cheirosa", "adorou", "agradavel",</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a> "qualidade", "benefício", "excelente", "seco", "diarreia",</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  "recomendo", "paladar", "duro", "aparencia", "hipoalergenico", </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  "grande", "alimentação", "proteíca", "aspecto", </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  "fezes", "coco", "melhorou" , "piorou" , "alergia" , "coceira" , "pata" ,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  "vermelho", "macio",  "ressecado", "esfarelento", "premium" ,"atrativo", "aceitação",</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>   "vegano", "ruim",  "energia", "quantidade", "caro", "barato", "embalagem"</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>termos_foco <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">c</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"composição"</span>, <span class="st">"natural"</span>, <span class="st">"cheiroso"</span>, <span class="st">"cheirosa"</span>, <span class="st">"adorou"</span>, <span class="st">"agradavel"</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a> <span class="st">"qualidade"</span>, <span class="st">"benefício"</span>, <span class="st">"excelente"</span>, <span class="st">"seco"</span>, <span class="st">"diarreia"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"recomendo"</span>, <span class="st">"paladar"</span>, <span class="st">"duro"</span>, <span class="st">"aparencia"</span>, <span class="st">"hipoalergenico"</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"grande"</span>, <span class="st">"alimentação"</span>, <span class="st">"proteíca"</span>, <span class="st">"aspecto"</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fezes"</span>, <span class="st">"coco"</span>, <span class="st">"melhorou"</span> , <span class="st">"piorou"</span> , <span class="st">"alergia"</span> , <span class="st">"coceira"</span> , <span class="st">"pata"</span> ,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vermelho"</span>, <span class="st">"macio"</span>,  <span class="st">"ressecado"</span>, <span class="st">"esfarelento"</span>, <span class="st">"premium"</span> ,<span class="st">"atrativo"</span>, <span class="st">"aceitação"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>   <span class="st">"vegano"</span>, <span class="st">"ruim"</span>,  <span class="st">"energia"</span>, <span class="st">"quantidade"</span>, <span class="st">"caro"</span>, <span class="st">"barato"</span>, <span class="st">"embalagem"</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>termos_foco <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">stri_trans_general</span>(termos_foco, <span class="st">"Latin-ASCII"</span>))</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>termos_validos <span class="ot">&lt;-</span> termos_foco[termos_foco <span class="sc">%in%</span> <span class="fu">colnames</span>(terms_df)]</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">lapply</span>(termos_validos, <span class="cf">function</span>(term) {</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  subset <span class="ot">&lt;-</span> terms_df[terms_df[[term]] <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Termo =</span> term,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    Média<span class="at">_Score =</span> <span class="fu">mean</span>(subset<span class="sc">$</span>Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    Frequência <span class="ot">=</span> <span class="fu">nrow</span>(subset)</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>resultados_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(resultados)</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>resultados_df <span class="ot">&lt;-</span> resultados_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Média_Score))</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Termo Média_Score Frequência
1       agradavel    5.000000          2
2       excelente    5.000000        371
3         paladar    5.000000         75
4  hipoalergenico    5.000000          4
5        melhorou    5.000000         25
6         coceira    5.000000          4
7            pata    5.000000          2
8     esfarelento    5.000000         19
9          vegano    5.000000          3
10       cheirosa    4.955224         67
11        alergia    4.951220        123
12        aspecto    4.950000         60
13     quantidade    4.869565         46
14       cheiroso    4.822581        124
15         adorou    4.809117        351
16      qualidade    4.802632        228
17        natural    4.715618        429
18           coco    4.691176         68
19          macio    4.686747         83
20      embalagem    4.635714        140
21          fezes    4.605096        314
22         grande    4.604651         86
23      recomendo    4.500000        204
24        energia    4.125000         24
25           ruim    4.000000         24
26           caro    3.600000         20
27        premium    3.478261         69
28       atrativo    3.250000         64
29           duro    3.159836        244
30           seco    3.037037        108
31       diarreia    2.268657         67
32      ressecado    1.136364         22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>resultados_por_marca <span class="ot">&lt;-</span> <span class="fu">lapply</span>(termos_validos, <span class="cf">function</span>(term) {</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  terms_df <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(.data[[term]] <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Termo =</span> term,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>      Média<span class="at">_Score =</span> <span class="fu">mean</span>(Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>      Frequência <span class="ot">=</span> <span class="fu">n</span>()</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>df_marca_termos <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(resultados_por_marca)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>resultados_por_marca <span class="ot">&lt;-</span> <span class="fu">lapply</span>(termos_validos, <span class="cf">function</span>(term) {</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  terms_df <span class="sc">%&gt;%</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(.data[[term]] <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">Termo =</span> term,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>      Média<span class="at">_Score =</span> <span class="fu">mean</span>(Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>      Frequência <span class="ot">=</span> <span class="fu">n</span>()</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>df_marca_termos <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(resultados_por_marca)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(df_marca_termos, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  Marca          Termo   Média_Score Frequência
  &lt;chr&gt;          &lt;chr&gt;         &lt;dbl&gt;      &lt;int&gt;
1 alles-pet      natural        5             3
2 mastig         natural        4.65         92
3 mister-maskoto natural        4.5           6
4 natural-crisp  natural        4.72        169
5 petvegan       natural        4.75        155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df_marca_termos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Marca              Termo            Média_Score      Frequência   
 Length:135         Length:135         Min.   :1.000   Min.   :  1.0  
 Class :character   Class :character   1st Qu.:4.000   1st Qu.:  4.0  
 Mode  :character   Mode  :character   Median :4.769   Median : 12.0  
                                       Mean   :4.245   Mean   : 25.7  
                                       3rd Qu.:5.000   3rd Qu.: 27.0  
                                       Max.   :5.000   Max.   :169.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(df_marca_termos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df_marca_termos</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Marca</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Termo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Média_Score</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.24</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.77</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">▁▁▂▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequência</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">25.70</td>
<td style="text-align: right;">33.73</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">169</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df_pivot <span class="ot">&lt;-</span> df_marca_termos <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Marca, Termo, Média_Score) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Termo,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Média_Score</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>df_pivot[<span class="fu">is.na</span>(df_pivot)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pca" class="level4">
<h4 class="anchored" data-anchor-id="pca">PCA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_pivot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df_pivot)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(df_pivot), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Marca  natural cheiroso cheirosa   adorou agradavel qualidade
1       alles-pet 5.000000 0.000000     0.00 4.800000         0  0.000000
2          mastig 4.652174 4.800000     5.00 4.823529         0  4.818182
3  mister-maskoto 4.500000 4.000000     4.75 4.714286         0  4.666667
4   natural-crisp 4.715976 4.795455     5.00 4.811881         0  4.769231
5        petvegan 4.748387 4.894737     5.00 4.811024         5  4.873418
6 the-pet-s-taste 5.000000 0.000000     0.00 5.000000         0  0.000000
  excelente     seco diarreia recomendo paladar     duro hipoalergenico
1         5 0.000000 0.000000  5.000000       0 0.000000              5
2         5 3.000000 2.333333  4.500000       5 3.125000              0
3         5 4.000000 1.000000  4.280000       0 3.200000              0
4         5 3.000000 2.333333  4.446154       5 3.195876              0
5         5 3.028571 2.500000  4.536232       5 3.236111              0
6         0 0.000000 0.000000  5.000000       0 0.000000              0
    grande aspecto    fezes     coco melhorou  alergia coceira pata    macio
1 0.000000     0.0 0.000000 0.000000        0 4.925926       0    0 0.000000
2 4.750000     5.0 4.600000 4.666667        5 5.000000       0    0 4.000000
3 5.000000     4.5 4.615385 4.500000        5 0.000000       0    0 4.600000
4 4.750000     5.0 4.600000 4.653846        5 5.000000       0    0 4.000000
5 4.791667     5.0 4.612500 4.791667        5 5.000000       0    5 4.895833
6 0.000000     0.0 0.000000 0.000000        0 4.888889       0    0 0.000000
  ressecado esfarelento  premium atrativo vegano ruim energia quantidade caro
1         0           0 0.000000 0.000000      0  0.0   0.000          0    3
2         1           5 3.333333 3.333333      0  5.0   4.000          5    0
3         2           0 3.333333 2.500000      0  1.0   4.000          3    0
4         1           5 3.333333 3.333333      0  5.0   4.000          5    0
5         1           5 3.809524 3.315789      5  3.5   4.375          5    5
6         0           0 0.000000 0.000000      0  0.0   0.000          0    3
  embalagem
1  0.000000
2  4.666667
3  4.400000
4  4.666667
5  4.659574
6  0.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(df_pivot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df_pivot</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Marca</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">natural</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.74</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">4.72</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▂▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">cheiroso</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.80</td>
<td style="text-align: right;">4.89</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cheirosa</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">adorou</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.71</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▂▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">agradavel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">qualidade</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.77</td>
<td style="text-align: right;">4.87</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">excelente</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.44</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">seco</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▇▁▁▅▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">diarreia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: left;">▇▂▁▁▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">recomendo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.64</td>
<td style="text-align: right;">2.08</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.28</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▂▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">paladar</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">duro</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: left;">▆▁▁▃▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hipoalergenico</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">grande</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: right;">2.36</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aspecto</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">fezes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">2.43</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.60</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coco</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.65</td>
<td style="text-align: right;">4.79</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">melhorou</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alergia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.89</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">coceira</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pata</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">macio</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.60</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▃▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ressecado</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: left;">▇▁▅▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">esfarelento</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">premium</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">3.81</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">atrativo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: left;">▇▁▁▂▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vegano</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruim</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">energia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.82</td>
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.38</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">quantidade</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▂▁▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">caro</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▅▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">embalagem</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">4.67</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df_pivot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Marca              natural         cheiroso        cheirosa    
 Length:9           Min.   :0.000   Min.   :0.000   Min.   :0.000  
 Class :character   1st Qu.:4.500   1st Qu.:0.000   1st Qu.:0.000  
 Mode  :character   Median :4.716   Median :0.000   Median :0.000  
                    Mean   :3.735   Mean   :2.054   Mean   :2.194  
                    3rd Qu.:5.000   3rd Qu.:4.795   3rd Qu.:5.000  
                    Max.   :5.000   Max.   :4.895   Max.   :5.000  
     adorou        agradavel        qualidade       excelente    
 Min.   :0.000   Min.   :0.0000   Min.   :0.000   Min.   :0.000  
 1st Qu.:4.714   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:5.000  
 Median :4.811   Median :0.0000   Median :0.000   Median :5.000  
 Mean   :3.753   Mean   :0.5556   Mean   :2.125   Mean   :4.444  
 3rd Qu.:4.812   3rd Qu.:0.0000   3rd Qu.:4.769   3rd Qu.:5.000  
 Max.   :5.000   Max.   :5.0000   Max.   :4.873   Max.   :5.000  
      seco          diarreia        recomendo       paladar     
 Min.   :0.000   Min.   :0.0000   Min.   :0.00   Min.   :0.000  
 1st Qu.:0.000   1st Qu.:0.0000   1st Qu.:4.28   1st Qu.:0.000  
 Median :0.000   Median :0.0000   Median :4.50   Median :0.000  
 Mean   :1.448   Mean   :0.9074   Mean   :3.64   Mean   :1.667  
 3rd Qu.:3.000   3rd Qu.:2.3333   3rd Qu.:5.00   3rd Qu.:5.000  
 Max.   :4.000   Max.   :2.5000   Max.   :5.00   Max.   :5.000  
      duro       hipoalergenico      grande         aspecto     
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000  
 Median :2.000   Median :0.000   Median :1.000   Median :0.000  
 Mean   :1.862   Mean   :1.111   Mean   :2.366   Mean   :2.167  
 3rd Qu.:3.196   3rd Qu.:0.000   3rd Qu.:4.750   3rd Qu.:5.000  
 Max.   :3.236   Max.   :5.000   Max.   :5.000   Max.   :5.000  
     fezes            coco          melhorou        alergia     
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000  
 Median :0.000   Median :0.000   Median :5.000   Median :4.889  
 Mean   :2.048   Mean   :2.068   Mean   :3.333   Mean   :3.300  
 3rd Qu.:4.600   3rd Qu.:4.654   3rd Qu.:5.000   3rd Qu.:5.000  
 Max.   :4.615   Max.   :4.792   Max.   :5.000   Max.   :5.000  
    coceira           pata            macio       ressecado     
 Min.   :0.000   Min.   :0.0000   Min.   :0.0   Min.   :0.0000  
 1st Qu.:0.000   1st Qu.:0.0000   1st Qu.:0.0   1st Qu.:0.0000  
 Median :0.000   Median :0.0000   Median :4.0   Median :0.0000  
 Mean   :1.111   Mean   :0.5556   Mean   :2.5   Mean   :0.5556  
 3rd Qu.:0.000   3rd Qu.:0.0000   3rd Qu.:4.6   3rd Qu.:1.0000  
 Max.   :5.000   Max.   :5.0000   Max.   :5.0   Max.   :2.0000  
  esfarelento       premium         atrativo         vegano      
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.0000  
 Median :0.000   Median :0.000   Median :0.000   Median :0.0000  
 Mean   :1.667   Mean   :1.534   Mean   :1.387   Mean   :0.5556  
 3rd Qu.:5.000   3rd Qu.:3.333   3rd Qu.:3.316   3rd Qu.:0.0000  
 Max.   :5.000   Max.   :3.810   Max.   :3.333   Max.   :5.0000  
      ruim          energia        quantidade      caro         embalagem    
 Min.   :0.000   Min.   :0.000   Min.   :0    Min.   :0.000   Min.   :0.000  
 1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0    1st Qu.:0.000   1st Qu.:0.000  
 Median :0.000   Median :0.000   Median :0    Median :0.000   Median :0.000  
 Mean   :1.611   Mean   :1.819   Mean   :2    Mean   :1.556   Mean   :2.044  
 3rd Qu.:3.500   3rd Qu.:4.000   3rd Qu.:5    3rd Qu.:3.000   3rd Qu.:4.660  
 Max.   :5.000   Max.   :4.375   Max.   :5    Max.   :5.000   Max.   :4.667  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df_pivot) <span class="ot">&lt;-</span> df_pivot[,<span class="dv">1</span>]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>df_pivot <span class="ot">&lt;-</span> df_pivot[ ,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>pc.cr <span class="ot">&lt;-</span> df_pivot <span class="sc">%&gt;%</span> <span class="fu">prcomp</span>(<span class="at">cor =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In prcomp.default(., cor = TRUE) :
 extra argument 'cor' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pc.cr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3    PC4    PC5     PC6     PC7
Standard deviation     9.8430 5.3248 3.10597 2.4813 2.0332 1.19209 0.03011
Proportion of Variance 0.6609 0.1934 0.06581 0.0420 0.0282 0.00969 0.00001
Cumulative Proportion  0.6609 0.8543 0.92010 0.9621 0.9903 0.99999 1.00000
                            PC8     PC9
Standard deviation     0.008298 9.4e-16
Proportion of Variance 0.000000 0.0e+00
Cumulative Proportion  1.000000 1.0e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>pc.cr<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      PC1        PC2        PC3         PC4          PC5
alles-pet       -8.332549 -5.6984770 -0.3666333  0.10060160  2.257900385
mastig          11.021158 -0.1491877 -1.7614787 -3.06708336  0.022802850
mister-maskoto   6.698905  2.8044524 -4.7223537  4.98230867 -0.021035981
natural-crisp   11.013745 -0.1389032 -1.7559130 -3.07097879  0.023873952
petvegan        12.273363 -1.8629705  6.7236609  2.12261644  0.034345240
the-pet-s-taste -8.036880 -5.0536060 -0.2399886  0.05446412 -4.778591785
wow-pet-food    -8.333727 -5.6878130 -0.3739017  0.11607973  2.258073846
organnact       -8.605349  7.4022598  1.1181544 -1.00419689  0.008391893
spin            -7.698665  8.3842452  1.3784537 -0.23381153  0.194239600
                        PC6           PC7           PC8           PC9
alles-pet       -0.05298617  7.506976e-04 -1.659056e-02  3.330669e-16
mastig          -0.09972293 -6.021315e-02 -1.903289e-04  4.440892e-16
mister-maskoto   0.19610390  4.166473e-05 -3.641528e-05  9.992007e-16
natural-crisp   -0.09929585  6.021175e-02  2.188058e-04  0.000000e+00
petvegan         0.14940134 -7.353642e-06  2.797972e-07 -8.881784e-16
the-pet-s-taste -0.13916859  1.990989e-05  4.398422e-06  7.771561e-16
wow-pet-food    -0.04888331 -7.338239e-04  1.659701e-02 -1.110223e-16
organnact        2.41992408 -3.968735e-05 -1.363768e-05  9.992007e-16
spin            -2.32537248 -3.001239e-05  1.044716e-05  8.881784e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>pc.cr<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       PC1           PC2         PC3          PC4          PC5
natural         0.08788944 -0.3516951997 -0.13867194  0.103617945 -0.031022588
cheiroso        0.24847670  0.0031603294 -0.03698487  0.017665590  0.009310075
cheirosa        0.26237621  0.0113117907 -0.08292465  0.072858225  0.009227898
adorou          0.09869890 -0.3400056048 -0.15056147  0.110492623 -0.057362578
agradavel       0.07917537 -0.0410655334  0.43560287  0.215465828  0.005192422
qualidade       0.25378695  0.0115820133 -0.07945322  0.084683293  0.008857504
excelente       0.05184585  0.1113968378  0.01554804 -0.005528628  0.722442693
seco            0.16781751  0.0207707049 -0.11763300  0.161269101  0.004834944
diarreia        0.11456586 -0.0111325548  0.05026856 -0.081883592  0.005253303
recomendo       0.07663052 -0.3524074498 -0.13408124  0.098520484 -0.031402672
paladar         0.22132235 -0.0474159316  0.20772316 -0.407606063  0.012249170
duro            0.12667958  0.1481660337  0.00678829  0.019028771  0.018040688
hipoalergenico -0.10751402 -0.2509884397 -0.04797672  0.021995223  0.682739336
grande          0.23309520  0.0860278181 -0.07262871  0.095187737  0.014626590
aspecto         0.26021548  0.0082208580 -0.06762740  0.047570631  0.009386912
fezes           0.24370489  0.0133380530 -0.09021651  0.092388978  0.008346568
coco            0.24725786  0.0103631326 -0.07029384  0.080930331  0.008690857
melhorou        0.15935987  0.3623852775  0.06352475 -0.027523851  0.039703356
alergia         0.06510565 -0.4026786604  0.14543412 -0.380618208 -0.024043323
coceira        -0.10517707  0.3479825540  0.16174666 -0.125669670  0.030634473
pata            0.07917537 -0.0410655334  0.43560287  0.215465828  0.005192422
macio           0.18133686  0.1963970918  0.05205986  0.154077074  0.037169541
ressecado       0.06155030  0.0152442757 -0.08083339  0.120779540  0.001177719
esfarelento     0.22132235 -0.0474159316  0.20772316 -0.407606063  0.012249170
premium         0.18389847  0.0056908125 -0.02399528  0.085951101  0.006540439
atrativo        0.16887772 -0.0005572039 -0.01601886 -0.019617455  0.006557751
vegano          0.07917537 -0.0410655334  0.43560287  0.215465828  0.005192422
ruim            0.20621266 -0.0227325406  0.01585328 -0.371095435  0.010055386
energia         0.21756770  0.0084422638 -0.04590731  0.094676592  0.007644538
quantidade      0.24725110 -0.0103247386  0.02415612 -0.104154934  0.010340998
caro           -0.01644055 -0.2584966999  0.39748802  0.231980138 -0.018629591
embalagem       0.24448406  0.0102037960 -0.07597458  0.064323705  0.008626541
                        PC6           PC7           PC8           PC9
natural        -0.047984419  5.752277e-01  6.925506e-02  4.509958e-01
cheiroso        0.049334150 -2.064488e-02 -1.560907e-02  1.111876e-02
cheirosa        0.060113839  2.125770e-02 -5.299528e-02 -9.246254e-02
adorou         -0.044067285 -5.180193e-02  4.083249e-01 -1.530995e-01
agradavel       0.065708256 -5.069950e-03  2.539947e-03  3.810648e-01
qualidade       0.060623343 -3.854771e-01 -7.639642e-02 -1.359938e-01
excelente       0.061207784 -1.372682e-02 -3.992807e-02  5.103058e-02
seco            0.056280940  1.933255e-02 -1.078140e-01 -3.188594e-02
diarreia        0.009256259  2.761358e-03  5.579254e-02  9.245325e-02
recomendo      -0.050875877 -4.025771e-01  2.908823e-02  5.248163e-02
paladar        -0.021822261 -6.031655e-03  2.610474e-01 -8.747951e-02
duro            0.059035182  5.837354e-01 -3.178372e-02 -4.534747e-01
hipoalergenico -0.044803251  1.163350e-02  5.855877e-02 -5.677181e-02
grande          0.074381901  1.334246e-02 -8.834765e-02 -1.056514e-01
aspecto         0.055801413  1.982142e-02 -3.646672e-02  1.586779e-01
fezes           0.059701815  2.095418e-02 -6.497273e-02 -2.125784e-01
coco            0.059010914 -8.634639e-02 -5.889940e-02  1.714383e-01
melhorou        0.106011035 -2.536032e-02 -9.848684e-02  1.174966e-01
alergia        -0.125650116  2.259893e-02 -7.582548e-01 -5.167108e-02
coceira         0.041584769 -4.805431e-02 -2.896300e-02  1.735096e-01
pata            0.065708256 -5.069950e-03  2.539947e-03 -3.570371e-02
macio          -0.949059312  1.934992e-06  4.816968e-06 -1.315689e-17
ressecado       0.030134958  1.028393e-02 -8.001902e-02 -7.067813e-02
esfarelento    -0.021822261 -6.031655e-03  2.610474e-01 -8.747951e-02
premium         0.049208773  1.464647e-02 -4.610733e-02 -9.617110e-02
atrativo        0.028345534  1.035951e-02  8.737068e-03 -5.238629e-02
vegano          0.065708256 -5.069950e-03  2.539947e-03 -3.570371e-02
ruim           -0.024285032  1.234458e-03  1.941712e-01  1.052565e-01
energia         0.056469132  1.777494e-02 -5.542858e-02 -7.089004e-02
quantidade      0.029926855  1.120373e-02  6.270466e-02  1.269018e-01
caro            0.002101635  1.014624e-02  6.163205e-02 -2.672309e-01
embalagem       0.055438056  1.965621e-02 -4.726206e-02  2.846646e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pc.cr, <span class="at">repel =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proximidade de atributos entre as marcas(MultiDimensional Scaling)"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">'Fonte: Webscraping - PetLove'</span>) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#theme_few()+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">size=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pc.cr <span class="ot">&lt;-</span> df_pivot <span class="sc">%&gt;%</span> <span class="fu">prcomp</span>(<span class="at">cor =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In prcomp.default(., cor = TRUE) :
 extra argument 'cor' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pc.cr, <span class="at">repel =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proximidade de atributos entre as marcas(MultiDimensional Scaling)"</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">'Fonte: Webscraping - PetLove'</span>) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">size=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df_marca_termos <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">soma_freq =</span> <span class="fu">sum</span>(Frequência))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  Marca           soma_freq
  &lt;chr&gt;               &lt;int&gt;
1 alles-pet              61
2 mastig                644
3 mister-maskoto        266
4 natural-crisp        1259
5 organnact              12
6 petvegan             1138
7 spin                   12
8 the-pet-s-taste        16
9 wow-pet-food           62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df_marca_termos <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weighted_score =</span> <span class="fu">sum</span>(Média_Score <span class="sc">*</span> Frequência) <span class="sc">/</span> <span class="fu">sum</span>(Frequência))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  Marca           weighted_score
  &lt;chr&gt;                    &lt;dbl&gt;
1 alles-pet                 4.72
2 mastig                    4.42
3 mister-maskoto            4.34
4 natural-crisp             4.44
5 organnact                 3.33
6 petvegan                  4.54
7 spin                      3.83
8 the-pet-s-taste           4.69
9 wow-pet-food              4.71</code></pre>
</div>
</div>
<p>Notamos uma estranha distorção aqui, a Organnact e a Spin se localizam de forma solitaria, o que de primeira olhada, parecem estar bem localizadas na percepção, mas na verdade, possuem um nivel amostral baixo para os termos escolhidos. Desta forma, priorizamos fazer un rebalanceamento amostral para que haja uma melhor reflexão da qualidade dos produtos e dos atributos aproximados. Tambem foram filtradas as marcas com baixa frequencia amostral, como a Organnact e a Spin.</p>
</section>
<section id="resampling" class="level4">
<h4 class="anchored" data-anchor-id="resampling">Resampling</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>df_resampled <span class="ot">&lt;-</span> df_marca_termos <span class="sc">%&gt;%</span>  </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="fu">min</span>(<span class="dv">100</span>, <span class="fu">n</span>()), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>df_resampled <span class="sc">%&gt;%</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weighted_score =</span> <span class="fu">sum</span>(Média_Score <span class="sc">*</span> Frequência) <span class="sc">/</span> <span class="fu">sum</span>(Frequência))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  Marca           weighted_score
  &lt;chr&gt;                    &lt;dbl&gt;
1 alles-pet                 4.69
2 mastig                    4.40
3 mister-maskoto            4.39
4 natural-crisp             4.29
5 organnact                 3.8 
6 petvegan                  4.48
7 spin                      5   
8 the-pet-s-taste           4.62
9 wow-pet-food              4.66</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df_resampled <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">soma_freq =</span> <span class="fu">sum</span>(Frequência))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  Marca           soma_freq
  &lt;chr&gt;               &lt;int&gt;
1 alles-pet              55
2 mastig                572
3 mister-maskoto        209
4 natural-crisp         743
5 organnact              10
6 petvegan              871
7 spin                    4
8 the-pet-s-taste        13
9 wow-pet-food           53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>df_resampled_Filt <span class="ot">&lt;-</span> df_resampled <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">sum</span>(Frequência) <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>df_resampled_Filt <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Marca) <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">soma_freq =</span> <span class="fu">sum</span>(Frequência))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Marca          soma_freq
  &lt;chr&gt;              &lt;int&gt;
1 alles-pet             55
2 mastig               572
3 mister-maskoto       209
4 natural-crisp        743
5 petvegan             871
6 wow-pet-food          53</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>df_pivot <span class="ot">&lt;-</span> df_resampled_Filt <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Marca, Termo, Média_Score) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Termo,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Média_Score</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>df_pivot[<span class="fu">is.na</span>(df_pivot)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>df_pivot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df_pivot)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(df_pivot), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Marca qualidade  natural cheirosa cheiroso   adorou aspecto
1         mastig  4.818182 4.652174     5.00 4.800000 4.823529     5.0
2      alles-pet  0.000000 5.000000     0.00 0.000000 4.800000     0.0
3  natural-crisp  4.769231 0.000000     5.00 4.795455 4.811881     5.0
4 mister-maskoto  4.666667 4.500000     4.75 4.000000 4.714286     4.5
5       petvegan  0.000000 4.748387     5.00 4.894737 4.811024     5.0
6   wow-pet-food  0.000000 0.000000     0.00 0.000000 4.812500     0.0
  quantidade agradavel paladar     coco ressecado atrativo recomendo  alergia
1          5         0       0 4.666667         0 3.333333      4.50 5.000000
2          0         0       0 0.000000         0 0.000000      0.00 4.925926
3          0         0       0 4.653846         1 0.000000      0.00 0.000000
4          0         0       0 0.000000         2 0.000000      4.28 0.000000
5          5         5       5 4.791667         1 3.315789      0.00 5.000000
6          0         0       0 0.000000         0 0.000000      0.00 4.888889
  energia     seco caro diarreia vegano hipoalergenico melhorou  premium
1   4.000 3.000000    0 2.333333      0              0        5 3.333333
2   0.000 0.000000    3 0.000000      0              5        0 0.000000
3   4.000 3.000000    0 2.333333      0              0        5 0.000000
4   4.000 4.000000    0 0.000000      0              0        5 3.333333
5   4.375 3.028571    5 2.500000      5              0        5 3.809524
6   0.000 0.000000    3 0.000000      0              5        0 0.000000
  embalagem    fezes esfarelento ruim pata     duro grande excelente macio
1  0.000000 4.600000           0  0.0    0 3.125000   0.00         5   0.0
2  0.000000 0.000000           0  0.0    0 0.000000   0.00         5   0.0
3  4.666667 4.600000           5  0.0    0 3.195876   4.75         0   4.0
4  4.400000 4.615385           0  1.0    0 3.200000   5.00         0   4.6
5  0.000000 4.612500           5  3.5    5 3.236111   0.00         5   0.0
6  0.000000 0.000000           0  0.0    0 0.000000   0.00         5   0.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(df_pivot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df_pivot</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Marca</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">qualidade</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">4.74</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">natural</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">4.58</td>
<td style="text-align: right;">4.72</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cheirosa</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.29</td>
<td style="text-align: right;">2.55</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">4.88</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">cheiroso</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4.40</td>
<td style="text-align: right;">4.80</td>
<td style="text-align: right;">4.89</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">adorou</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.80</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">4.71</td>
<td style="text-align: right;">4.80</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: left;">▂▁▁▂▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">aspecto</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">quantidade</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">agradavel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">paladar</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">coco</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.35</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">4.79</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ressecado</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: left;">▇▁▅▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">atrativo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">recomendo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">2.27</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">alergia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">4.91</td>
<td style="text-align: right;">4.98</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">energia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.73</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.38</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">seco</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▅▁▁▇▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">caro</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▅▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">diarreia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vegano</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">hipoalergenico</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">melhorou</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">premium</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">3.81</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">embalagem</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.51</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">4.67</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">fezes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.07</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">4.60</td>
<td style="text-align: right;">4.61</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">esfarelento</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">ruim</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: left;">▇▂▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pata</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">duro</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grande</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.56</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">excelente</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">macio</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.60</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df_pivot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Marca             qualidade        natural         cheirosa    
 Length:6           Min.   :0.000   Min.   :0.000   Min.   :0.000  
 Class :character   1st Qu.:0.000   1st Qu.:1.125   1st Qu.:1.188  
 Mode  :character   Median :2.333   Median :4.576   Median :4.875  
                    Mean   :2.376   Mean   :3.150   Mean   :3.292  
                    3rd Qu.:4.744   3rd Qu.:4.724   3rd Qu.:5.000  
                    Max.   :4.818   Max.   :5.000   Max.   :5.000  
    cheiroso         adorou         aspecto        quantidade   
 Min.   :0.000   Min.   :4.714   Min.   :0.000   Min.   :0.000  
 1st Qu.:1.000   1st Qu.:4.803   1st Qu.:1.125   1st Qu.:0.000  
 Median :4.398   Median :4.811   Median :4.750   Median :0.000  
 Mean   :3.082   Mean   :4.796   Mean   :3.250   Mean   :1.667  
 3rd Qu.:4.799   3rd Qu.:4.812   3rd Qu.:5.000   3rd Qu.:3.750  
 Max.   :4.895   Max.   :4.824   Max.   :5.000   Max.   :5.000  
   agradavel         paladar            coco         ressecado     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.0000  
 Median :0.0000   Median :0.0000   Median :2.327   Median :0.5000  
 Mean   :0.8333   Mean   :0.8333   Mean   :2.352   Mean   :0.6667  
 3rd Qu.:0.0000   3rd Qu.:0.0000   3rd Qu.:4.663   3rd Qu.:1.0000  
 Max.   :5.0000   Max.   :5.0000   Max.   :4.792   Max.   :2.0000  
    atrativo       recomendo        alergia         energia     
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:0.000   1st Qu.:0.000   1st Qu.:1.222   1st Qu.:1.000  
 Median :0.000   Median :0.000   Median :4.907   Median :4.000  
 Mean   :1.108   Mean   :1.463   Mean   :3.302   Mean   :2.729  
 3rd Qu.:2.487   3rd Qu.:3.210   3rd Qu.:4.981   3rd Qu.:4.000  
 Max.   :3.333   Max.   :4.500   Max.   :5.000   Max.   :4.375  
      seco            caro          diarreia         vegano      
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:0.750   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.0000  
 Median :3.000   Median :1.500   Median :1.167   Median :0.0000  
 Mean   :2.171   Mean   :1.833   Mean   :1.194   Mean   :0.8333  
 3rd Qu.:3.021   3rd Qu.:3.000   3rd Qu.:2.333   3rd Qu.:0.0000  
 Max.   :4.000   Max.   :5.000   Max.   :2.500   Max.   :5.0000  
 hipoalergenico     melhorou        premium        embalagem    
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:0.000   1st Qu.:1.250   1st Qu.:0.000   1st Qu.:0.000  
 Median :0.000   Median :5.000   Median :1.667   Median :0.000  
 Mean   :1.667   Mean   :3.333   Mean   :1.746   Mean   :1.511  
 3rd Qu.:3.750   3rd Qu.:5.000   3rd Qu.:3.333   3rd Qu.:3.300  
 Max.   :5.000   Max.   :5.000   Max.   :3.810   Max.   :4.667  
     fezes        esfarelento         ruim           pata       
 Min.   :0.000   Min.   :0.000   Min.   :0.00   Min.   :0.0000  
 1st Qu.:1.150   1st Qu.:0.000   1st Qu.:0.00   1st Qu.:0.0000  
 Median :4.600   Median :0.000   Median :0.00   Median :0.0000  
 Mean   :3.071   Mean   :1.667   Mean   :0.75   Mean   :0.8333  
 3rd Qu.:4.609   3rd Qu.:3.750   3rd Qu.:0.75   3rd Qu.:0.0000  
 Max.   :4.615   Max.   :5.000   Max.   :3.50   Max.   :5.0000  
      duro            grande        excelente         macio      
 Min.   :0.0000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:0.7812   1st Qu.:0.000   1st Qu.:1.250   1st Qu.:0.000  
 Median :3.1604   Median :0.000   Median :5.000   Median :0.000  
 Mean   :2.1262   Mean   :1.625   Mean   :3.333   Mean   :1.433  
 3rd Qu.:3.1990   3rd Qu.:3.562   3rd Qu.:5.000   3rd Qu.:3.000  
 Max.   :3.2361   Max.   :5.000   Max.   :5.000   Max.   :4.600  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df_pivot) <span class="ot">&lt;-</span> df_pivot[,<span class="dv">1</span>]</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>df_pivot <span class="ot">&lt;-</span> df_pivot[ ,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>pc.cr <span class="ot">&lt;-</span> df_pivot <span class="sc">%&gt;%</span> <span class="fu">prcomp</span>(<span class="at">cor =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In prcomp.default(., cor = TRUE) :
 extra argument 'cor' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pc.cr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3     PC4     PC5       PC6
Standard deviation     8.5750 6.7695 4.1926 3.03913 1.34290 9.494e-16
Proportion of Variance 0.4969 0.3097 0.1188 0.06242 0.01219 0.000e+00
Cumulative Proportion  0.4969 0.8066 0.9254 0.98781 1.00000 1.000e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>pc.cr<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     PC1         PC2        PC3       PC4          PC5
mastig         -4.260889  -2.8416918 -7.1940569  2.717076 -0.003370617
alles-pet      10.898251   0.4211809 -0.3960876 -1.161463 -2.077169672
natural-crisp  -6.965921   5.9574517  4.6286715  3.486553 -0.596532223
mister-maskoto -6.139588   6.9227640 -1.4810632 -4.640054  0.524246048
petvegan       -4.626755 -11.6624593  3.3378212 -1.558074  0.139869819
wow-pet-food   11.094902   1.2027543  1.1047149  1.155962  2.012956644
                         PC6
mastig          8.604228e-16
alles-pet       2.775558e-17
natural-crisp  -7.216450e-16
mister-maskoto -3.330669e-16
petvegan        9.992007e-16
wow-pet-food   -4.163336e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pc.cr$rotation</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pc.cr, <span class="at">repel =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proximidade de atributos entre as marcas(MultiDimensional Scaling)"</span>,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">'Fonte: Webscraping - PetLove'</span>) <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#theme_few()+</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>,</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">size=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>pc.cr <span class="ot">&lt;-</span> df_pivot <span class="sc">%&gt;%</span> <span class="fu">prcomp</span>(<span class="at">cor =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In prcomp.default(., cor = TRUE) :
 extra argument 'cor' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pc.cr, <span class="at">repel =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proximidade de atributos entre as marcas(MultiDimensional Scaling)"</span>,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">'Fonte: Webscraping - PetLove'</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">size=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Trabalho_Final_Markteting_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretação" class="level4">
<h4 class="anchored" data-anchor-id="interpretação">Interpretação</h4>
<p>Conclusão do PCA e do GGrepel:</p>
<p>A partir da modelagem utilizando o método de Topic Models, foi possível identificar os principais temas recorrentes nos comentários de compradores de petiscos para cachorros. Em seguida, vetorizamos esses tópicos com base nas notas de avaliação dos usuários, a fim de verificar quais estavam associados a percepções mais positivas ou negativas.</p>
<p>Dessa forma, foi possível realizar o PCA e a visualização com ggrepel, que nos permitiram entender como as marcas desse mercado estão sendo percebidas pelos consumidores. Entretanto, as notas baixas de algumas empresas mas a boa localização destes no grafico de localização do PCA estavam suspeitas (no caso principal de Organnact e Spin), isto se deve a um desbalanço à quantidade amostral destas marcas com comentarios que incluem de fato estes termos</p>
<p>Apos uma filtragem mais incisiva e um resampling, chegamos a um numero menor de marcas, mas com uma analise visual mais palpavel. O alto numero de avaliações para a Natural Crispy estava distorcendo a a distancia dos atributos das outras marcas, com esse rebalanceamento amostral, fomos capazes de separar quatro territorios para cadaquadrante no plano cartesiano</p>
<p>As marcas Alles Pet e Wow estao no campo de petiscos naturais, caros, hipoalergenicos e com boa recepção dos animais. Mister Maskoto, no quarto quadrante, apesar de estar solitario de outras marcas se aproxima dos vetores de boas embalagens, melhora de condições e recomendações. Mas ja começa a ficar perto de atributos mal-vistos como “ressecado”</p>
<p>PetVegan, apesar de ser bem avaliado e visto como um petisco que nao incorre risco ou ate melhora condições como consistencia das fezes e dar energia aso melhores amigos, tamebm se encaixa bem na propposta de ser uma opção natural que oferec uma boa quantidade, apesar estar sujeito a criticas de tutores insatisfeitos</p>
<p>Mastig esta localizado em um lugar perigoso para a identidade da marca, perto dos atributos negativos como diarreia (causado por reações alergicas), percepção de ser um produto ruim e esfarelento. Apoesar de ainda ser entendido como um produto natural</p>
<p>Mister maskoto e Natual Crisp estao proximas, oferecendo um produto acessível em grandes quantidades, com boa embalagem, macio e bem recomendado. Apesar de terem apontamentos sobre o produto ser ressecado. Importante notar que nas analises com uma gama amostral maior e em outras seeds testadas no rebalanceamento amostral, estas duas marcas ficaram bem proximas dos vetores negativos ligados à reações alergicas aos cães (proximidade com o vetor “diarréia”)</p>
<p>De forma geral, esse tipo de análise textual é essencial para que as marcas compreendam a percepção real dos consumidores na Petlove, possibilitando a identificação de pontos de melhoria e a definição de ações estratégicas mais eficazes.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>